# respon



•user_id(購入者id)
•accessed_at (アクション日時)
•event_action (アクション内容　remove_from_cart,purchase,add_to_wishlist,add_to_cart,view,favorite,checkout)
•product_id (製品id)
•creator_name (クリエイター名)
•creator_id (クリエイターid)
•title (製品タイトル)
•description (製品説明)
•item_id (アイテムid)
•item_name (アイテム名)
•item_category_id (アイテムカテゴリーid)
•item_category_name (アイテムカテゴリー名)
•exemplary_item_color_id(下記に対応するid)
•exemplary_item_color_name(メインで販売している色名)
•material_1~material_12 (使用マテリアルidが1〜12個。複数使用していない場合はnan)
•material_url (マテリアル画像のリンク)
•sale_1~sale_18 (セール参加フラグ　計18回)
•profit(suzuriの利益)
•price(商品の価格)


クリエイターテーブル
•creator_id(クリエイターid)
•name(クリエイター名)
•display_name(表示クリエイター名)
•created_at(アカウント作成日)
•official(suzuri公認かそうでないか)
•bio(紹介文)


Total Transactions: 504168
Total Purchases: 33227

--- [Analysis 1] Whale Impact Check ---
Top 30 Overlap Rate (金額ランク vs 人数ランク): 0.50
Ranking Churn Rate (入れ替わり率): 0.50
Gini Coefficient of Top Item ('43113465'): 0.70
>> JUDGMENT: GO (一部のユーザーによる売上依存度が高く、Whale対策が必要です)

--- [Analysis 2] Exploration Potential ---
Similarity Bins vs Avg Co-purchase:
sim_bin
(0.589, 0.618]    0.000000
(0.618, 0.647]    0.003006
(0.647, 0.675]    0.002969
(0.675, 0.704]    0.003164
(0.704, 0.733]    0.003177
(0.733, 0.761]    0.003323
(0.761, 0.79]     0.003261
(0.79, 0.818]     0.003191
(0.818, 0.847]    0.003769
(0.847, 0.875]    0.008850
Name: co_purchase, dtype: float64

--- [Analysis 3] LTV Impact (Single vs Multi Creator) ---
Avg LTV (Single Creator): ¥56,740
Avg LTV (Multi Creator):  ¥54,714
LTV Uplift: 0.96x
>> JUDGMENT: CAUTION (単推しと複数推しでLTVに大きな差がありません)

--- [Analysis 4] Seasonal Category Transition ---
データ不足のため季節性分析をスキップしました






① 「ユーザーのエントロピー（趣味の散らばり具合）」概念: そのユーザーの好みが「一点集中型（単推し）」か「多趣味（箱推し）」かを数値化する。計算: 購入したクリエイターやカテゴリの分布から、シャノンエントロピーを計算。エントロピー低：特定のクリエイターしか買わない（保守的）。エントロピー高：色々なものを買う（冒険好き）。活用: バンディットアルゴリズムの**「探索率（ε）」を動的に変える**のに使えます。（冒険好きな人には、より大胆なレコメンドをする）。② クリエイターの「モメンタム（勢い）」概念: 単純な累積売上ではなく、「今キテるか？」を捉える。株価のテクニカル分析に近い。計算: 売上の移動平均線の傾き（微分値）。活用: まだ累積売上は少ないが、急激に伸びている「新人」をフックアップする。③ 時間の「周期的埋め込み (Cyclical Time Encoding)」概念: 季節性を「4月、5月」という数字ではなく、円環状のデータとして扱う。計算: 月（Month）や日（Day）を $sin$ と $cos$ に変換。$x_{sin} = \sin(2\pi \times \frac{month}{12})$, $x_{cos} = \cos(2\pi \times \frac{month}{12})$活用: 12月と1月が「数値的には遠いが、季節的には隣」であることをモデルに正しく理解させる。RNNの精度向上に直結します。④ コミュニティ密度 (Cluster Coefficient)概念: GNN分析から得られる指標。計算: ユーザーが属している「界隈」の結合密度。活用: 密度が高い（内輪ノリが強い）界隈のユーザーには、他界隈の商品を勧めると離脱しやすいので、あえて探索を弱める、といった制御が可能。




1. リピート購買分析 🔄
リピート率: 94.2% (非常に高い！)
購買間隔: 10.3日 (中央値)
➡️ モデル設計への示唆:

ユーザーは頻繁に戻ってくるため、パーソナライズされた履歴ベースのレコメンドが非常に有効
10日サイクルでリマインド通知や新着商品通知が効果的
RNN/LSTMなどの時系列モデルが購買パターンを捉えやすい環境
2. 閲覧→購入の転換分析 📱
全体の転換率: 10.25%
購入者の閲覧数(中央値): 9回
62.1%のユーザーが5回以下の閲覧で初回購入
➡️ モデル設計への示唆:

セッションベースのレコメンドが重要（閲覧履歴を活用）
9回程度の閲覧で購入決定するため、リアルタイムレコメンドの精度が鍵
「この商品を見た人はこれも見ています」が効果的
3. カテゴリ多様性分析 🌈
74.7%が複数カテゴリを購入
複数カテゴリユーザーは平均21回購入 vs 単一カテゴリユーザーは8.6回
67.3%は同じカテゴリ内でリピート購入
➡️ モデル設計への示唆:

カテゴリ内推薦(67%)とクロスカテゴリ推薦(33%)を7:3の比率で配置
多様なカテゴリを推薦することでLTVが2.5倍になる可能性
「このクリエイターの別カテゴリ商品」が有効
人気カテゴリ: t-shirts(51%) > stationery(22%)
4. クリエイターロングテール分析 📉
Top 20%のクリエイターが74.6%の売上
わずか6%のクリエイターで売上の50%
HHI: 0.0155 (分散している)
➡️ モデル設計への示唆:

人気クリエイターに偏りすぎると多様性が失われる
ロングテールクリエイターに10-20%の露出枠を確保
「隠れた名作」「新進クリエイター」枠を設ける
Explore/Exploit のバランス最適化が重要
5. コールドスタート分析 🆕
62.1%が5回以下の閲覧で購入 = 即決型ユーザー
初回購入の人気カテゴリ: t-shirts(43%) > stationery(23%)
初回購入価格帯: ¥2,030-¥3,950（中央値¥3,110）
➡️ モデル設計への示唆:

初回表示(トップページ)の精度が最重要
新規ユーザーには以下を優先表示:
人気のt-shirts・stationery
価格帯¥2,000-4,000の商品
トレンド商品・ランキング上位
コンテンツベースフィルタリングで類似商品を提示
🛠️ 推奨レコメンドシステムアーキテクチャ
ハイブリッドアプローチ
重要な設計ポイント
✅ Whale対策: 購入回数でダウンウェイト
✅ 多様性確保: ロングテール20%枠
✅ リアルタイム性: セッションベースレコメンド
✅ カテゴリバランス: 同一67% / クロス33%
✅ 初回表示最適化: A/Bテストで継続改善




最終データからわかることまとめ
・商品数148043件、ユーザー数約2400、購入したことのあるユーザー数1861、クリエイター数26247
・一つの商品に複数のマテリアルが使われているものがある。カレンダーなど
・売り上げの多いクリエイターのほとんどが購入者は一人だけ
・購入回数にたいしてviewの数が明らかに少なすぎる出品者がいる。
→購入者が一人でviewも全然していなかったり、カートに追加回数も購入回数・総購入個数に対して少なすぎる出品者情報を予測に使っていいものか？
・add_to_cartがゼロで購入されている出品者がいる。しかも売り上げでは上位の出品者
カートに追加せずに購入する手段があるらしい
・4月にもっとも売り上げが伸び、5月で急降下し、また6月で急上昇、7,8,9月と緩やかに下降していく。4月は売上個数が約5000、6月が約4300であり、1,2,3,11,12月に関しては1000程度である。
・売り上げの上位5アイテムはT-shirt、sticker,long-sleeve-t-shirt,one-point-t-shirt,acrylic-keychainであった。この中でもt-shirtがほとんどの売り上げを占めている。T-shirtは全体の売り上げ変動と同じであり、4月に最大の2300を出している。それ以外のアイテムは一年を通して毎月伸びがあまり見られず横ばいに100~300程度である。
・冬にパーカーやスウェットなどがt-shirtの代わりに台頭していない。季節性はあまりない
・冬になると一番の売れ筋のt-shirtですら下がりこみ全体の売り上げが下がっている。
・ほぼ毎月セールがあり(セールによって対象の商品は違う)、やはりセール中にviewも購入も激増する。セール初日にviewがピークを迎え、最終日に購入がピークになる。
・7月28日だけt-shirtが異常に購入されている。前後の日はふつう
・6月7日にviewの数が異常に伸びている。要因はセールか？
・7月１７日にfavoriteが異常に伸びている
・セール中にしか買われていないクリエイターがいる
・アイテムごとの購入者の偏りのジニ係数が0.52。でもクリエイターごとの購入者の偏りによるジニ係数を求めるべきでは？
・実際に画像埋め込みベクトルをもちいてクリエイター類似度と併売数の探索のポテンシャルに関しては分析するべき
・一人のクリエイターからしか購入していないユーザーと複数から購入しているユーザーとのLTVに大きな差はない
・94.2%のユーザーが期間内に二回以上は購入している
・ユーザーの平均カテゴリ購入数2.76
・単一カテゴリユーザー: 471 (25.3%)複数カテゴリユーザー: 1,390 (74.7%)
・単一カテゴリユーザーの平均購入数: 8.56複数カテゴリユーザーの平均購入数: 21.00
・次の購入も同じカテゴリ: 67.3%次の購入は別カテゴリ: 32.7%
・カテゴリー売り上げ個数ではt-shirtが17017でトップ、次点でstationeryが7239
・総クリエイター数: 2,860に対してTop 20%のクリエイターの売上シェア: 74.6%、売上50%を占めるクリエイター数: 170 (5.9%)であり、数少ないクリエイターに頼り切っている状態。しかもそのトップのクリエイターも一人のユーザーのみの購入で支えられていることが多い
・閲覧なし購入に関してもう少し分析するべき
・既存のレコメンド機能による効果がセールの際は少し出ている。
急成長期間の検出結果：
        period  　　　　　　rapid_growth_products  top_growth_rate  top_product_id
2025-04-09 - 2025-04-16                      4              2.0        10433503
2025-06-11 - 2025-06-18                      1              2.5        43113465

四月の11周年感謝祭で4つのプロダクトが2倍の成長している。
・成長率 > 1.0 の商品を「トレンド」として優先表示することで効果期待できそう。でも成長率高い商品が多くはなさそう
・ユーザーのアクセス、購入が多いのは上から日、金、月。日が購入数6656で最下位の水曜日が3398と差がある。しかし、セール最終日に購入が集まりやすことがわかっており、日曜日がセール最終日であることが多いためこのまま予測に利用するとバイアスがかかりそう。
・しかしピークの時間帯の上位３位が14時代、１３時台、１２時台に集中している。曜日ごとにも見てみる必要はありそう
・鮮度スコアに関してはデータに出品日がないため参考にならない。しかし、11月末にデスクトップカレンダーを新しく登場させているためデータは少ないがこれで今のレコメンドで新商品がどのくらい購入されており、どのくらい目につきやすくなっているかが考察できそう。
・閲覧数と購入数の相関関係が0.097で無相関
・クリエイター・ロイヤルティ 114.1% → 同一クリエイターから複数購入する傾向
・商品共起の平均回数: 2.1回 → 閲覧パターンに類似性あり
・商品ID一致の元お気に入り→購入の転換率: 5.8%であり低すぎる


モデルに関して
・CF(画像、テキストでのアイテム類似度)コンテンツ+セール補正
→0.0079
・埋め込み＋協調フィルタリング
→0.02
・簡易ResNet画像特徴量+強化版協調フィルタリング(アイテムCF + ユーザーCF + 時間減衰人気度)
→0.0145




=== Generating Dummy Data for Testing ===
--- [1/6] Preprocessing & Merging ---
Total Log Records: 591954
--- [2/6] Detecting Noise & Suspicious Transactions ---
--- [3/6] Feature Engineering ---
--- [4/6] Creating Clean Data Mart (Filtering) ---
Original Records: 591954
Cleaned Records:  591954
Removed Records:  0
--- [5/6] Running Deep Dive Analysis ---
Analysis 1: Cross-Selling Potential...
Top 5 Materials used in Cross-Selling:
material_url
https://d1q9av5b648rmv.cloudfront.net/v3/400x400/17226588/1738865215-1280x1280.png.png?h=c709015d52bbedaceb1f83fe62d823524d30f2c0    5
https://d1q9av5b648rmv.cloudfront.net/v3/400x400/18449055/1755781245-2664x3548.jpg.png?h=9fe62e014b716bed200cb997b34641bdd89b9576    4
https://d1q9av5b648rmv.cloudfront.net/v3/400x400/17073923/1735504136-1000x1000.png.png?h=d910f1310f9c0cd8cb31390a24d944b74e9b5a87    3
https://d1q9av5b648rmv.cloudfront.net/v3/400x400/17083041/1735772885-1284x1340.jpg.png?h=98e818d0231ff373977699ac023718b2402daee4    3
https://d1q9av5b648rmv.cloudfront.net/v3/400x400/18027424/1750152463-1280x1280.png.png?h=2d0974564ed1b19bd51f155a3cf8514aa7bf2e68    3
Name: count, dtype: int64

Analysis 2: Price & Profit Analysis...
Correlation Matrix:
                  price    profit  profit_margin       cvr
price          1.000000  0.616604      -0.261249  0.008386
profit         0.616604  1.000000       0.535037 -0.021541
profit_margin -0.261249  0.535037       1.000000 -0.033607
cvr            0.008386 -0.021541      -0.033607  1.000000

Analysis 3: Text Mining (Top Keywords)...
Top Keywords: ['amami' 'com' 'dog' 'https' 'men' 'www' 'お値段変わります' 'さあ'
 'それぞれのカラーを選択されますと' 'それぞれのカラーを選択されますとお値段をご確認いただけます' 'できあがりイメージがご確認いただけます'
 'タイトル' 'チームasuka' 'デザインが染み込まないよう工程がプラスされるため' 'デザインが染み込んだような仕上がりになります'
 'ハブ' '濃いお色のボディをご希望ですと' '画像タイトル' '画像説明' '薄いお色のボディは']

--- Processing Complete ---
Noise Report: {'self_purchase_count': np.int64(0), 'dominant_buyer_transactions': 259584, 'direct_buy_transactions': 46931}

Sample of Cleaned Data (Top 3 rows):
                                             user_id  product_id  ... is_sale_target  creator_gini_index
0  0001612a3121be9136950b33ca144e4337b0759a68ce62...    58403574  ...          False                 0.0
1  0001612a3121be9136950b33ca144e4337b0759a68ce62...    47733744  ...          False                 0.0
2  0001612a3121be9136950b33ca144e4337b0759a68ce62...    17076616  ...          False                 0.0

[3 rows x 5 columns]
